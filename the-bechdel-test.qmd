---
title: "Bechdel Test"
format: html
embed-resources: true
execute: 
  warning: false
  echo: true
  error: false
---


<!--- this a comment in Quarto, it is a great way to leave yourself notes that you don't want to appear in your final document. Just highlight the text and use CTRL+ALT+C to comment or uncomment--->

```{r}
#| label: setup
#| include: false

library(tidyverse)
library(mosaic)
#library(ggformula)
```


<!-- Note there is some code in there that you may not understand. THAT IS OK! The goal is to learn how to read errors - you will learn many of these functions in your classes.   -->


In this mini analysis we work with the data used in the FiveThirtyEight story titled ["The Dollar-And-Cents Case Against Hollywood's Exclusion of Women"](https://fivethirtyeight.com/features/the-dollar-and-cents-case-against-hollywoods-exclusion-of-women/).

1. Your task is to fill in the blanks denoted by `___` with text or code.  
2. Fix any errors.  
3. Identify specific R code function and how you looked them up.  


## Import Data

Now import the data:

```{r}
#| label: read-bechdel
bechdel <- read_csv("bechdel.csv")
```




## Types of Markdown Code

### Inline Code

The dataset contains information on `r length(bechdel$year)` movies released between `r min(bechdel$year)` and `r max(bechdel$year)`.


### Headers

Notice that each time we begin something with hashtags, it creates a header. The number of hastags corresponds to the size of the header.


### Text Types

We can type regularly into any qmd file. But we can also **bold** text or *italicize* text with simple modifications to the text.  We can also make our text look like `code`. 


## Data Cleaning

However we'll focus our analysis on movies released between 1990 and 2013.

```{r}
#| label: filter-data
# this code pulls out just rows with years between 1990 and 2013
# then it creates a new variable for return on investment
bechdel90_13 <- bechdel |> 
  filter(between(year, 1990, 2013)) |> 
  mutate(roi = (intgross_2013 + domgross_2013) / budget_2013)
```


The financial variables we'll focus on are the following:  

-  `budget_2013`: Budget in 2013 inflation adjusted dollars  
-  `domgross_2013`: Domestic gross (US) in 2013 inflation adjusted dollars  
-  `intgross_2013`: Total International (i.e., worldwide) gross in 2013 inflation adjusted dollars  

And we'll also use the `binary` and `clean_test` variables for **grouping**.


## Analysis

Let's take a look at how median budget and domestic gross vary by whether the movie passed the Bechdel test, which is stored in the `binary` variable. We will use the variables scaled to a valuation for 2013.  


### Error: Object Not Found

Run the code below:

```{r}
median(budget_2031 ~ binary, data = bechdel90_13)
```
What does the error "Object Not Found" indicate here?

>Insert Answer



### Error: Function returns "NA"

Now run this code:

```{r}
median(domgross_2013 ~ binary, data = bechdel90_13)
```
Why did it return NA? Add `na.rm = TRUE` into the function and see what happens.

>Insert Answer




## Budget and Gross vs. The Bechdel Test

Next, let's take a look at how median budget and gross vary by a more detailed indicator of the Bechdel test result.

This information is stored in the `clean_test` variable, which takes on the following values:

-   `ok` = passes test
-   `dubious`
-   `men` = women only talk about men
-   `notalk` = women don't talk to each other
-   `nowomen` = fewer than two women

 
### Error: could not find function

Below is a visualization of the return on investment by test result, however it's difficult to see the distributions due to a few extreme observations.   

```{r}
gfboxplot(roi ~ clean_test,
           data = bechdel90_13,
           xlab = "Detailed Bechdel result",
           ylab = "Return on Investment",
           title = "Return on investment vs. Bechdel test result")
```

### Error: Unexpected Symbol in:

Here is a graph "zoomed" in to allow us to exclude the major outliers.

```{r}
gf_boxplot(roi ~ clean_test 
           data = bechdel90_13,
           xlab = "Detailed Bechdel result",
           ylab = "Return on Investment",
           title = "Return on investment vs. Bechdel test result")  |> 
  gf_lims(y = c(0, 15))
```





